(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/scMapDetail/scMapDetail"],{"32c7":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("view",{staticClass:"content"},[e("view",{directives:[{name:"show",rawName:"v-show",value:!t.showRead&&!t.drawerShow&&!t.markPayShow,expression:"!showRead && !drawerShow && !markPayShow"}],staticClass:"map"},[e("map",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"map","show-location":t.isUnloack,latitude:t.center.latitude,markers:t.markers,longitude:t.center.longitude,eventid:"15b6f680-7"},on:{markertap:t.handleScMark}},[t.player.playerShow?e("cover-view",{staticClass:"player-lock",attrs:{eventid:"15b6f680-0",mpcomid:"15b6f680-0"},on:{click:t.closePlayer}}):t._e(),t.isUnloack?t._e():e("cover-view",{staticClass:"lock",attrs:{mpcomid:"15b6f680-1"}}),!t.isUnloack&&t.detail.voiceTotal&&t.detail.narratorPrice?e("cover-view",{staticClass:"scInfo",attrs:{mpcomid:"15b6f680-2"}},[t._v("共"+t._s(t.detail.voiceTotal)+"个景点讲解 "+t._s(t.detail.narratorPrice)+"元/份")]):t._e(),e("cover-view",{staticClass:"drawerBtn",attrs:{src:"../../static/image/xz.png",eventid:"15b6f680-1",mpcomid:"15b6f680-3"},on:{click:t.showDrawer}},[t._v("景区详情")]),t.isUnloack?t._e():e("cover-view",{staticClass:"unlock",attrs:{eventid:"15b6f680-2",mpcomid:"15b6f680-4"},on:{click:t.showPay}},[t._v("尚未解锁该景区，去解锁")]),e("cover-view",{directives:[{name:"show",rawName:"v-show",value:t.drawerShow||t.payDialogShow,expression:"drawerShow || payDialogShow"}],staticClass:"cust-drawer-zz",attrs:{eventid:"15b6f680-3",mpcomid:"15b6f680-5"},on:{click:function(a){a.stopPropagation(),t.closeDrawer(a)}}}),t.payDialogShow?e("cover-view",{staticClass:"cust-pay",attrs:{mpcomid:"15b6f680-13"}},[e("cover-view",{staticClass:"cust-pay-title",attrs:{mpcomid:"15b6f680-6"}},[t._v("解锁提示")]),e("cover-view",{staticClass:"cust-pay-p",attrs:{mpcomid:"15b6f680-7"}},[t._v("你尚未解锁该景区语音讲解")]),e("cover-view",{staticClass:"cust-pay-p",attrs:{mpcomid:"15b6f680-8"}},[t._v("支付"+t._s(t.detail.narratorPrice)+"元后可解锁改景区")]),e("cover-view",{staticClass:"cust-pay-btn",attrs:{eventid:"15b6f680-4",mpcomid:"15b6f680-9"},on:{click:t.mackPay}},[t._v("去支付")]),e("cover-view",{staticClass:"cust-pay-xy",attrs:{eventid:"15b6f680-5",mpcomid:"15b6f680-12"},on:{click:t.read}},[e("cover-image",{attrs:{src:t.isXy?"../../static/image/sleing.png":"../../static/image/noslecing.png",mpcomid:"15b6f680-10"}}),e("cover-view",{attrs:{mpcomid:"15b6f680-11"}},[t._v("《用户购买协议》")])],1)],1):t._e(),t.player.playerShow?e("cover-view",{staticClass:"player",attrs:{mpcomid:"15b6f680-18"}},[e("cover-view",{staticClass:"player-top",attrs:{mpcomid:"15b6f680-16"}},[e("cover-image",{staticClass:"player-bg",attrs:{src:t.player.img,mpcomid:"15b6f680-14"}}),e("cover-image",{staticClass:"player-btn",attrs:{src:1===t.player["play"]?"../../static/image/play.png":"../../static/image/stop.png",eventid:"15b6f680-6",mpcomid:"15b6f680-15"},on:{click:t.audioPlay}})],1),e("cover-view",{staticClass:"player-bottom els",attrs:{mpcomid:"15b6f680-17"}},[t._v(t._s(t.player.spotName))])],1):t._e()],1)],1),e("van-popup",{attrs:{show:t.markPayShow,position:"right",mpcomid:"15b6f680-19"}},[e("view",{staticClass:"cust-drawer"},[e("form",{attrs:{"report-submit":!0,eventid:"15b6f680-9"},on:{submit:t.formSubmit}},[e("view",{staticClass:"btn-area"},[e("button",{attrs:{formType:"submit"}},[t._v("支付")]),e("button",{attrs:{eventid:"15b6f680-8"},on:{click:function(a){t.markPayShow=!1}}},[t._v("关闭")])],1)])],1)]),e("van-popup",{attrs:{show:t.drawerShow,position:"right",mpcomid:"15b6f680-20"}},[e("view",{staticClass:"cust-drawer"},[e("view",{staticClass:"introduce"},[e("image",{staticClass:"introduce-close",attrs:{src:"../../static/image/close2.png",mode:"",eventid:"15b6f680-10"},on:{click:function(a){t.drawerShow=!1}}}),e("view",{staticClass:"introduce-cap"},[e("view",{staticClass:"introduce-cap-icon"}),e("view",{staticClass:"introduce-cap-txt"},[t._v("景区介绍")])]),e("view",{staticClass:"introduce-txt"},[e("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.introduction))])]),e("view",{staticClass:"introduce-cap"},[e("view",{staticClass:"introduce-cap-icon"}),e("view",{staticClass:"introduce-cap-txt"},[t._v("开放时间")])]),e("view",{staticClass:"introduce-txt"},[e("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.openTime))])]),e("view",{staticClass:"introduce-cap"},[e("view",{staticClass:"introduce-cap-icon"}),e("view",{staticClass:"introduce-cap-txt"},[t._v("门票售价")])]),e("view",{staticClass:"introduce-txt"},[e("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.ticketPrice)+"元/人")])]),t.detail.busRoutes?e("view",{staticClass:"introduce-cap"},[e("view",{staticClass:"introduce-cap-icon"}),e("view",{staticClass:"introduce-cap-txt"},[t._v("公交路线")])]):t._e(),t.detail.busRoutes?e("view",{staticClass:"introduce-txt"},[e("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.busRoutes)+"啊实打实大所大所大所大所大所大所大所大所大所大所大")])]):t._e()])])]),e("van-popup",{attrs:{show:t.showRead,position:"right",mpcomid:"15b6f680-21"}},[e("view",{staticClass:"xy-container"},[e("view",{staticClass:"article"},[e("view",{staticClass:"bigCap"},[t._v("知四方用户服务协议")]),e("view",[e("view",{staticClass:"txt suojin"},[t._v("欢迎您注册并使用贵州紫光科技有限公司提供的服务，本协议由贵州紫光科技有限公司（以下简称我公司）与用户（指注册、登录、使用本服务的个人，以下简称为“您”）就知四方平台（以下简称“本产品”）提供的服务所订立的相关权利义务规范。请您认真阅读此服务协议的内容（特别是粗体、下划线标注内容）。如不同意此服务协议，请勿使用或注册该服务。用户在注册过程中勾选“我已认真阅读并接受用户服务协议”，并填写用户信息完成注册。即表示用户完全接受本协议中的全部内容，此后，用户不得以未阅读本服务条款内容作任何形式的抗辩。除非另有明确规定，本产品所推出的新功能、新服务，均无条件的使用本协议。")])]),e("view",{staticClass:"cap"},[t._v("一、用户注册")]),e("view",[e("text",{staticClass:"txt"},[t._v("1、用户使用本产品的前提是认真阅读本协议并通过注册。用户注册是指用户登录本平台，按用户注册流程要求填写相关信息并同意接受本服务协议的过程。")])]),e("view",[e("text",{staticClass:"txt"},[t._v("2、使用该服务的用户必须是完全民事行为能力人，具备相应的权利能力和行为能力，能够独立承担法律责任。限制民事行为能力人和无民事行为能力人不能注册或使用该服务。如经发现，本产品有权立即停止与该用户的交易、注销该用户账户。")])]),e("view",[e("text",{staticClass:"txt"},[t._v("3、用户在注册时需要完善个人资料，保证遵守法律法规、社会主义制度、国家利益、公民合法权益、公共秩序、社会道德风尚和信息真实，不得在资料中出现违法和不良信息。若用户注册资料存在违法和不良信息的，本平台有权采取通知限期改正、暂停使用、注销用户、向政府主管部门报告等措施。")])]),e("view",[e("text",{staticClass:"txt"},[t._v("4、用户应提供真实有效的个人信息并进行实名认证，未经实名认证，不能使用本产品服务。")])]),e("view",{staticClass:"cap"},[t._v("二、账号和密码安全")]),e("view",[e("text",{staticClass:"txt"},[t._v("1、用户应负责保管其账号和密码，对该账户下的所有活动和时间负全部责任。如果用户未保管好自己的账号和密码而对用户本人、本产品或第三方造成损害，用户承担全部责任。")])]),e("view",[e("text",{staticClass:"txt"},[t._v("2、用户同意若发现任何非法使用用户账号或安全漏洞的情况，应立即通知我们。")])]),e("view",{staticClass:"cap"},[t._v("三、账号和密码安全")]),e("view",[e("text",{staticClass:"txt"},[t._v("1、本服务的具体内容由本产品根据实际情况提供，包括但不限于用户使用本产品的景点介绍、语音讲解等。本产品可以对提供的服务予以变更，且本产品提供的服务内容可随时变更，用户将会受到关于服务变更的通知。")])]),e("view",[e("text",{staticClass:"txt"},[t._v("2、除非本协议另有其他明示规定，本公司推出的新产品、新功能、新服务，均受到本协议条款之规范。")])]),e("view",{staticClass:"cap"},[t._v("四、账号和密码安全")]),e("view",[e("text",{staticClass:"txt"},[t._v("1、如系统发生故障影响到用户服务的正常运行，我公司承诺及时处理进行修复。但用户因此而产生的损失，本公司不承担责任。")])]),e("view",[e("text",{staticClass:"txt"},[t._v("2、涉及到互联网服务，可能会受到各个环节不稳定因素的影响，存在因不可抗力、计算机病毒、黑客攻击、系统不稳定、用户所在位置、用户关机以及其他任何网络、技术、通信线路等原因造成的服务中断或不能满足用户要求的风险，用户须自行承担以上风险，本公司不承担任何责任。")])]),e("view",[e("text",{staticClass:"txt"},[t._v("3、用户明确同意使用本产品服务的风险由用户个人承担。本公司明确表示不提供任何类型的担保，不论是明确的或隐含的。用户理解并接受由其承担系统受损、资料丢失以及其它任何风险。")])]),e("view",[e("view",{staticClass:"txt"},[t._v("4、用户享有言论自由权利，但用户在本产品中不得发表含有如下内容的言论，否则本产品有权删除用户所发言论，并有权采取停止用户服务、拒绝用户参加所有抢宝商品项目等措施："),e("view",[e("text",{staticClass:"txt"},[t._v("（1）反对宪法所确定的基本原则，煽动、抗拒、破坏宪法和法律、行政法规的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（2）煽动颠覆国家政权，推翻社会主义制度，煽动、分裂国家，破坏国家统一的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（3）损害国家荣誉和利益的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（4）煽动民族仇恨、民族歧视，破坏民族团结的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（5）任何包含对种族、性别、宗教、地域内容等歧视的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（6）捏造或者歪曲事实，散布谣言，扰乱社会秩序的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（7）宣扬封建迷信、邪教、淫秽、色情、赌博、暴力、凶杀、恐怖、教唆犯罪的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（8）公然侮辱他人或者捏造事实诽谤他人的，或者进行其他恶意攻击的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（9）损害国家机关信誉的；")])]),e("view",[e("text",{staticClass:"txt"},[t._v("（10）其他违反宪法和法律行政法规的。")])])])]),e("view",{staticClass:"cap"},[t._v("五、服务条款的变更与修订")]),e("view",[e("text",{staticClass:"txt"},[t._v("我公司保留在任何时候修改本协议条款的权利，且无需另行通知。我公司修改协议条款后，如果您不接受修改后的条款，请立即停止使用本产品提供的服务，继续使用本产品提供的服务将被视为接受修改后的协议。用户在享受该服务时，应当及时查阅了解修改的内容，并自觉遵守本服务协议。")])]),e("view",{staticClass:"btns"},[e("button",{attrs:{size:"mini",plain:"",type:"primary",eventid:"15b6f680-11"},on:{click:function(a){t.agree("no")}}},[t._v("拒绝")]),e("button",{attrs:{size:"mini",type:"primary",eventid:"15b6f680-12"},on:{click:function(a){t.agree("yes")}}},[t._v("同意")])],1)])])])],1)},s=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return s})},3699:function(t,a,e){"use strict";var i=e("fd08"),s=e.n(i);s.a},8050:function(t,a,e){"use strict";e.r(a);var i=e("32c7"),s=e("9e72");for(var o in s)"default"!==o&&function(t){e.d(a,t,function(){return s[t]})}(o);e("3699");var c=e("2877"),r=Object(c["a"])(s["default"],i["a"],i["b"],!1,null,null,null);a["default"]=r.exports},"9e72":function(t,a,e){"use strict";e.r(a);var i=e("b99b"),s=e.n(i);for(var o in i)"default"!==o&&function(t){e.d(a,t,function(){return i[t]})}(o);a["default"]=s.a},b99b:function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(e("a34a")),s=c(e("784f")),o=c(e("65d7"));function c(t){return t&&t.__esModule?t:{default:t}}function r(t,a,e,i,s,o,c){try{var r=t[o](c),n=r.value}catch(l){return void e(l)}r.done?a(n):Promise.resolve(n).then(i,s)}function n(t){return function(){var a=this,e=arguments;return new Promise(function(i,s){var o=t.apply(a,e);function c(t){r(o,i,s,c,n,"next",t)}function n(t){r(o,i,s,c,n,"throw",t)}c(void 0)})}}var l=e("bec1"),d={data:function(){return{isUnloack:!1,mapId:"",center:{longitude:106.63,latitude:26.65},payDialogShow:!1,drawerShow:!1,isXy:!0,markers:[],showRead:!1,detail:{},markPayShow:!1,player:{id:"",playerShow:!1,play:1,img:"",spotName:"",voiceUrl:"",voiceName:""},audio:t.getBackgroundAudioManager()}},onLoad:function(){var a=n(i.default.mark(function a(e){var s,o,c,r;return i.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,l.isLogin();case 2:if(s=a.sent,s){a.next=8;break}return a.next=6,l.logining();case 6:o=a.sent,o||(c=getCurrentPages(),r=c[c.length-1].route.slice(c[c.length-1].route.lastIndexOf("/")+1),t.redirectTo({url:"../userInfoAuth/userInfoAuth?goBack="+r}));case 8:this.mapId=e.id,this.mapId&&this.getDetail();case 10:case"end":return a.stop()}},a,this)}));function e(t){return a.apply(this,arguments)}return e}(),onShow:function(){var t=n(i.default.mark(function t(){return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t,this)}));function a(){return t.apply(this,arguments)}return a}(),onUnload:function(){this.audio.stop(),this.player={id:"",playerShow:!1,play:1,img:"",spotName:"",voiceUrl:"",voiceName:""}},onHide:function(){},methods:{audioPlay:function(){var a=this;if(console.log(this.audio.paused),!1===this.audio.paused)return this.audio.stop(),void(this.player["play"]=1);void 0!==this.audio.paused&&!0!==this.audio.paused||(this.audio.src=this.player.voiceUrl,this.audio.title=this.player.voiceName,this.audio.play(),this.audio.onPlay(function(){a.player["play"]=2}),this.audio.onError(function(e){t.showToast({title:"播放错误",icon:"none"}),a.player["play"]=1}),this.audio.onEnded(function(t){a.player["play"]=1}))},closePlayer:function(){this.player["playerShow"]=!1,this.audio.stop(),this.player={id:"",playerShow:!1,play:1,img:"",spotName:"",voiceUrl:"",voiceName:""}},read:function(){this.isXy=!0,this.showRead=!0},getDetail:function(){var a=this,e=t.createMapContext("map",this);this.markers=[],o.default.rq({url:s.default.moreSpotList+"/"+this.mapId}).then(function(i){if(200===i.code){a.detail=i.data,a.isUnloack=!!a.detail.orderId,a.center["longitude"]=i.data.lon,a.center["latitude"]=i.data.lat;var s=[{latitude:i.data.lat,longitude:i.data.lon}];i.data.scenicSpotList.forEach(function(t){a.markers.push({latitude:t.lat,longitude:t.lon,id:t.id,iconPath:"../../static/image/spot.png",width:40,height:48,photo:t.photo,spotName:t.spotName,label:{content:t.spotName,anchorX:-16*(t.spotName.length/2).toFixed(2),fontSize:12,borderWidth:1,borderColor:"#019ce4",padding:4,bgColor:"#fff",color:"#019ce4",borderRadius:10,textAlign:"center"}}),s.push({latitude:t.lat,longitude:t.lon})}),e.includePoints({points:s,padding:[40,40,40,40]})}else t.showToast({title:i.message,icon:"none"}),a.isUnloack=!1,a.detail={}})},showDrawer:function(){this.drawerShow=!0},showPay:function(){this.payDialogShow=!0},closeDrawer:function(){this.drawerShow=!1,this.payDialogShow=!1},handleScMark:function(a){var e=this,i=a.mp;o.default.rq({url:s.default.voice,data:{scenicId:this.detail.id,spotId:i.markerId,narratorId:this.detail.narratorId},header:{"content-type":"application/x-www-form-urlencoded",token:t.getStorageSync("login-token")},goBackWithParmas:{id:this.mapId},loading:!0}).then(function(a){if(200===a.code){if(!a.data)return void t.showToast({title:"没有语音",icon:"none"});e.player["id"]=a.data.id,e.player["voiceUrl"]=a.data.voiceUrl,e.player["voiceName"]=a.data.voiceName,e.markers.forEach(function(t){t.id===i.markerId&&(e.player["img"]=t.photo,e.player["spotName"]=t.spotName)}),e.player["playerShow"]=!0}else t.showToast({title:a.message,icon:"none"})})},agree:function(t){this.isXy="yes"==t,this.showRead=!1},mackPay:function(){this.isXy?(this.payDialogShow=!1,this.markPayShow=!0):t.showToast({title:"请阅读协议并同意",icon:"none"})},formSubmit:function(a){var e=this,i={formId:a.detail.formId,narratorId:this.detail.narratorId,scenicId:this.detail.id};t.showLoading({title:"生成订单中"}),o.default.rq({url:s.default.localCreateOrder,method:"POST",data:i}).then(function(a){t.hideLoading(),200===a.code?(t.showLoading({title:"支付中"}),o.default.rq({url:s.default.payOrder,method:"POST",data:a.data}).then(function(a){t.hideLoading(),200===a.code?(t.showToast({title:"支付成功",icon:"none"}),e.markPayShow=!1,e.payDialogShow=!1,e.getDetail()):t.showToast({title:"支付失败",icon:"none"})})):t.showToast({title:a.message,icon:"none"})})},requestOrder:function(){var a={};t.request({url:s.default.localCreateOrder,method:"POST",data:a,header:{"content-type":"application/x-www-form-urlencoded",token:t.getStorageSync("login-token")},success:function(a){if(a.data.code,214===a.data.code){t.showToast({title:"登录过期，请重新登录",duration:2e3,icon:"none"});var e=getCurrentPages(),i=e[e.length-1].route.slice(e[e.length-1].route.lastIndexOf("/")+1);t.navigateTo({url:"../userInfoAuth/userInfoAuth?goBack="+i})}},fail:function(t){}})}},watch:{payDialogShow:function(t){!0===t&&(this.isXy=!0)}}};a.default=d}).call(this,e("649d")["default"])},d78e:function(t,a,e){"use strict";e("ce60");var i=o(e("b0ce")),s=o(e("8050"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))},fd08:function(t,a,e){}},[["d78e","common/runtime","common/vendor"]]]);