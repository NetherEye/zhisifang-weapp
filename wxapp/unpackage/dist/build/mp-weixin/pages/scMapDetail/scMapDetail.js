(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/scMapDetail/scMapDetail"],{"0db3":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"content"},[a("view",{directives:[{name:"show",rawName:"v-show",value:!t.showRead&&!t.drawerShow,expression:"!showRead && !drawerShow"}],staticClass:"map"},[a("map",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"map",markers:t.what.markers,eventid:"15b6f680-8"},on:{updated:t.mapUpdate,markertap:t.handleScMark}},[t.goIndex?a("cover-view",{staticClass:"goIndex",attrs:{eventid:"15b6f680-0",mpcomid:"15b6f680-0"},on:{click:t.goToIndex}},[t._v("前往首页")]):t._e(),t.player.playerShow?a("cover-view",{staticClass:"player-lock",attrs:{eventid:"15b6f680-1",mpcomid:"15b6f680-1"},on:{click:t.closePlayer}}):t._e(),2!==t.isUnloack&&t.MoneyHide?a("cover-view",{staticClass:"lock",attrs:{mpcomid:"15b6f680-2"}}):t._e(),1===t.isUnloack&&t.detail.voiceTotal&&t.detail.narratorPrice&&t.MoneyHide?a("cover-view",{staticClass:"scInfo",attrs:{mpcomid:"15b6f680-3"}},[t._v("共"+t._s(t.detail.voiceTotal)+"个景点讲解 "+t._s(t.detail.narratorPrice)+"元/份")]):t._e(),a("cover-view",{staticClass:"drawerBtn",attrs:{src:"../../static/image/xz.png",eventid:"15b6f680-2",mpcomid:"15b6f680-4"},on:{click:t.showDrawer}},[t._v("景区详情")]),1===t.isUnloack&&t.MoneyHide?a("cover-view",{staticClass:"unlock",attrs:{eventid:"15b6f680-3",mpcomid:"15b6f680-5"},on:{click:t.showPay}},[t._v("尚未解锁该景区，去解锁")]):t._e(),a("cover-view",{directives:[{name:"show",rawName:"v-show",value:t.payDialogShow,expression:"payDialogShow"}],staticClass:"cust-drawer-zz",attrs:{eventid:"15b6f680-4",mpcomid:"15b6f680-6"},on:{click:function(e){e.stopPropagation(),t.closeDrawer(e)}}}),t.payDialogShow&&t.MoneyHide?a("cover-view",{staticClass:"cust-pay",attrs:{mpcomid:"15b6f680-14"}},[a("cover-view",{staticClass:"cust-pay-title",attrs:{mpcomid:"15b6f680-7"}},[t._v("解锁提示")]),a("cover-view",{staticClass:"cust-pay-p",attrs:{mpcomid:"15b6f680-8"}},[t._v("你尚未解锁该景区语音讲解")]),a("cover-view",{staticClass:"cust-pay-p",attrs:{mpcomid:"15b6f680-9"}},[t._v("支付"+t._s(t.detail.narratorPrice)+"元后可解锁该景区")]),a("cover-view",{staticClass:"cust-pay-btn",attrs:{eventid:"15b6f680-5",mpcomid:"15b6f680-10"},on:{click:t.mackPay}},[t._v("去支付")]),a("cover-view",{staticClass:"cust-pay-xy",attrs:{eventid:"15b6f680-6",mpcomid:"15b6f680-13"},on:{click:t.read}},[a("cover-image",{attrs:{src:t.isXy?"../../static/image/sleing.png":"../../static/image/noslecing.png",mpcomid:"15b6f680-11"}}),a("cover-view",{attrs:{mpcomid:"15b6f680-12"}},[t._v("《用户购买协议》")])],1)],1):t._e(),t.player.playerShow?a("cover-view",{staticClass:"player",attrs:{mpcomid:"15b6f680-19"}},[a("cover-view",{staticClass:"player-top",attrs:{mpcomid:"15b6f680-17"}},[a("cover-image",{staticClass:"player-bg",attrs:{src:t.player.img,mpcomid:"15b6f680-15"}}),a("cover-image",{staticClass:"player-btn",attrs:{src:1===t.player["play"]?"../../static/image/play.png":"../../static/image/stop.png",eventid:"15b6f680-7",mpcomid:"15b6f680-16"},on:{click:t.audioPlay}})],1),a("cover-view",{staticClass:"player-bottom els",attrs:{mpcomid:"15b6f680-18"}},[t._v(t._s(t.player.spotName))])],1):t._e()],1)],1),a("van-popup",{attrs:{show:t.drawerShow,"z-index":2e3,position:"right",eventid:"15b6f680-9",mpcomid:"15b6f680-20"},on:{close:t.closeDrawerShow}},[a("view",{staticClass:"cust-drawer"},[a("view",{staticClass:"introduce"},[a("view",{staticClass:"introduce-cap"},[a("view",{staticClass:"introduce-cap-icon"}),a("view",{staticClass:"introduce-cap-txt"},[t._v("景区介绍")])]),a("view",{staticClass:"introduce-txt"},[a("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.introduction))])]),a("view",{staticClass:"introduce-cap"},[a("view",{staticClass:"introduce-cap-icon"}),a("view",{staticClass:"introduce-cap-txt"},[t._v("开放时间")])]),a("view",{staticClass:"introduce-txt"},[a("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.openTime))])]),a("view",{staticClass:"introduce-cap"},[a("view",{staticClass:"introduce-cap-icon"}),a("view",{staticClass:"introduce-cap-txt"},[t._v("门票售价")])]),a("view",{staticClass:"introduce-txt"},[a("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.ticketPrice)+"元/人")])]),t.detail.busRoutes?a("view",{staticClass:"introduce-cap"},[a("view",{staticClass:"introduce-cap-icon"}),a("view",{staticClass:"introduce-cap-txt"},[t._v("公交路线")])]):t._e(),t.detail.busRoutes?a("view",{staticClass:"introduce-txt"},[a("text",{staticClass:"introduce-txt-p"},[t._v(t._s(t.detail.busRoutes))])]):t._e()])])]),a("van-popup",{attrs:{show:t.showRead,position:"right",mpcomid:"15b6f680-21"}},[a("view",{staticClass:"xy-container"},[a("view",{staticClass:"article"},[a("view",{staticClass:"bigCap"},[t._v("知四方用户服务协议")]),a("view",[a("view",{staticClass:"txt suojin"},[t._v("欢迎您注册并使用贵州紫光科技有限公司提供的服务，本协议由贵州紫光科技有限公司（以下简称我公司）与用户（指注册、登录、使用本服务的个人，以下简称为“您”）就知四方平台（以下简称“本产品”）提供的服务所订立的相关权利义务规范。请您认真阅读此服务协议的内容（特别是粗体、下划线标注内容）。如不同意此服务协议，请勿使用或注册该服务。用户在注册过程中勾选“我已认真阅读并接受用户服务协议”，并填写用户信息完成注册。即表示用户完全接受本协议中的全部内容，此后，用户不得以未阅读本服务条款内容作任何形式的抗辩。除非另有明确规定，本产品所推出的新功能、新服务，均无条件的使用本协议。")])]),a("view",{staticClass:"cap"},[t._v("一、用户注册")]),a("view",[a("text",{staticClass:"txt"},[t._v("1、用户使用本产品的前提是认真阅读本协议并通过注册。用户注册是指用户登录本平台，按用户注册流程要求填写相关信息并同意接受本服务协议的过程。")])]),a("view",[a("text",{staticClass:"txt"},[t._v("2、使用该服务的用户必须是完全民事行为能力人，具备相应的权利能力和行为能力，能够独立承担法律责任。限制民事行为能力人和无民事行为能力人不能注册或使用该服务。如经发现，本产品有权立即停止与该用户的交易、注销该用户账户。")])]),a("view",[a("text",{staticClass:"txt"},[t._v("3、用户在注册时需要完善个人资料，保证遵守法律法规、社会主义制度、国家利益、公民合法权益、公共秩序、社会道德风尚和信息真实，不得在资料中出现违法和不良信息。若用户注册资料存在违法和不良信息的，本平台有权采取通知限期改正、暂停使用、注销用户、向政府主管部门报告等措施。")])]),a("view",[a("text",{staticClass:"txt"},[t._v("4、用户应提供真实有效的个人信息并进行实名认证，未经实名认证，不能使用本产品服务。")])]),a("view",{staticClass:"cap"},[t._v("二、账号和密码安全")]),a("view",[a("text",{staticClass:"txt"},[t._v("1、用户应负责保管其账号和密码，对该账户下的所有活动和时间负全部责任。如果用户未保管好自己的账号和密码而对用户本人、本产品或第三方造成损害，用户承担全部责任。")])]),a("view",[a("text",{staticClass:"txt"},[t._v("2、用户同意若发现任何非法使用用户账号或安全漏洞的情况，应立即通知我们。")])]),a("view",{staticClass:"cap"},[t._v("三、账号和密码安全")]),a("view",[a("text",{staticClass:"txt"},[t._v("1、本服务的具体内容由本产品根据实际情况提供，包括但不限于用户使用本产品的景点介绍、语音讲解等。本产品可以对提供的服务予以变更，且本产品提供的服务内容可随时变更，用户将会受到关于服务变更的通知。")])]),a("view",[a("text",{staticClass:"txt"},[t._v("2、除非本协议另有其他明示规定，本公司推出的新产品、新功能、新服务，均受到本协议条款之规范。")])]),a("view",{staticClass:"cap"},[t._v("四、账号和密码安全")]),a("view",[a("text",{staticClass:"txt"},[t._v("1、如系统发生故障影响到用户服务的正常运行，我公司承诺及时处理进行修复。但用户因此而产生的损失，本公司不承担责任。")])]),a("view",[a("text",{staticClass:"txt"},[t._v("2、涉及到互联网服务，可能会受到各个环节不稳定因素的影响，存在因不可抗力、计算机病毒、黑客攻击、系统不稳定、用户所在位置、用户关机以及其他任何网络、技术、通信线路等原因造成的服务中断或不能满足用户要求的风险，用户须自行承担以上风险，本公司不承担任何责任。")])]),a("view",[a("text",{staticClass:"txt"},[t._v("3、用户明确同意使用本产品服务的风险由用户个人承担。本公司明确表示不提供任何类型的担保，不论是明确的或隐含的。用户理解并接受由其承担系统受损、资料丢失以及其它任何风险。")])]),a("view",[a("view",{staticClass:"txt"},[t._v("4、用户享有言论自由权利，但用户在本产品中不得发表含有如下内容的言论，否则本产品有权删除用户所发言论，并有权采取停止用户服务、拒绝用户参加所有抢宝商品项目等措施："),a("view",[a("text",{staticClass:"txt"},[t._v("（1）反对宪法所确定的基本原则，煽动、抗拒、破坏宪法和法律、行政法规的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（2）煽动颠覆国家政权，推翻社会主义制度，煽动、分裂国家，破坏国家统一的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（3）损害国家荣誉和利益的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（4）煽动民族仇恨、民族歧视，破坏民族团结的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（5）任何包含对种族、性别、宗教、地域内容等歧视的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（6）捏造或者歪曲事实，散布谣言，扰乱社会秩序的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（7）宣扬封建迷信、邪教、淫秽、色情、赌博、暴力、凶杀、恐怖、教唆犯罪的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（8）公然侮辱他人或者捏造事实诽谤他人的，或者进行其他恶意攻击的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（9）损害国家机关信誉的；")])]),a("view",[a("text",{staticClass:"txt"},[t._v("（10）其他违反宪法和法律行政法规的。")])])])]),a("view",{staticClass:"cap"},[t._v("五、服务条款的变更与修订")]),a("view",[a("text",{staticClass:"txt"},[t._v("我公司保留在任何时候修改本协议条款的权利，且无需另行通知。我公司修改协议条款后，如果您不接受修改后的条款，请立即停止使用本产品提供的服务，继续使用本产品提供的服务将被视为接受修改后的协议。用户在享受该服务时，应当及时查阅了解修改的内容，并自觉遵守本服务协议。")])]),a("view",{staticClass:"btns"},[a("button",{attrs:{size:"mini",plain:"",type:"primary",eventid:"15b6f680-10"},on:{click:function(e){t.agree("no")}}},[t._v("拒绝")]),a("button",{attrs:{size:"mini",type:"primary",eventid:"15b6f680-11"},on:{click:function(e){t.agree("yes")}}},[t._v("同意")])],1)])])])],1)},s=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return s})},3699:function(t,e,a){"use strict";var i=a("fd08"),s=a.n(i);s.a},8050:function(t,e,a){"use strict";a.r(e);var i=a("0db3"),s=a("9e72");for(var o in s)"default"!==o&&function(t){a.d(e,t,function(){return s[t]})}(o);a("3699");var c=a("2877"),n=Object(c["a"])(s["default"],i["a"],i["b"],!1,null,null,null);e["default"]=n.exports},"9e72":function(t,e,a){"use strict";a.r(e);var i=a("b99b"),s=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=s.a},b99b:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("a34a")),s=n(a("784f")),o=n(a("65d7")),c=a("2f62");function n(t){return t&&t.__esModule?t:{default:t}}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},i=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),i.forEach(function(e){l(t,e,a[e])})}return t}function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function d(t,e,a,i,s,o,c){try{var n=t[o](c),r=n.value}catch(l){return void a(l)}n.done?e(r):Promise.resolve(r).then(i,s)}function u(t){return function(){var e=this,a=arguments;return new Promise(function(i,s){var o=t.apply(e,a);function c(t){d(o,i,s,c,n,"next",t)}function n(t){d(o,i,s,c,n,"throw",t)}c(void 0)})}}var p=a("bec1"),v={data:function(){return{isUnloack:0,mapId:"",payDialogShow:!1,drawerShow:!1,isXy:!0,markers:[],what:{markers:[]},showRead:!1,detail:{},player:{id:"",playerShow:!1,play:1,img:"",spotName:"",voiceUrl:"",voiceName:""},audio:t.getBackgroundAudioManager(),goIndex:!1}},onLoad:function(){var e=u(i.default.mark(function e(a){var s,o,c,n;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.isLogin();case 2:if(s=e.sent,s){e.next=8;break}return e.next=6,p.logining();case 6:o=e.sent,o||(c=getCurrentPages(),n=c[c.length-1].route.slice(c[c.length-1].route.lastIndexOf("/")+1),t.redirectTo({url:"../userInfoAuth/userInfoAuth?goBack="+n+"&goBackWithParmas="+JSON.stringify({id:this.mapId})}));case 8:return this.mapId=a.id,this.mapId&&this.getDetail(),e.t0=this.$store,e.next=13,p.getMoneyHide();case 13:e.t1=e.sent,e.t0.commit.call(e.t0,"setMoneyHide",e.t1);case 15:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),onShow:function(){this.what={markers:[]},this.mapId&&this.getDetail();var t=getCurrentPages();1===t.length?this.goIndex=!0:this.goIndex=!1},onUnload:function(){this.audio.stop(),this.player={id:"",playerShow:!1,play:1,img:"",spotName:"",voiceUrl:"",voiceName:""}},onHide:function(){},methods:{mapUpdate:function(t){},goToIndex:function(){t.redirectTo({url:"../index/index"})},closeDrawerShow:function(){this.drawerShow=!1},audioPlay:function(){var e=this;if(!1===this.audio.paused)return this.audio.stop(),void(this.player["play"]=1);void 0!==this.audio.paused&&!0!==this.audio.paused||(this.audio.src=this.player.voiceUrl,this.audio.title=this.player.voiceName,this.audio.play(),this.audio.onPlay(function(){e.player["play"]=2}),this.audio.onError(function(a){t.showToast({title:"播放错误",icon:"none"}),e.player["play"]=1}),this.audio.onEnded(function(t){e.player["play"]=1}))},closePlayer:function(){this.player["playerShow"]=!1,this.audio.stop(),this.player={id:"",playerShow:!1,play:1,img:"",spotName:"",voiceUrl:"",voiceName:""}},read:function(){this.isXy=!0,this.showRead=!0},getDetail:function(){var e=this,a=t.createMapContext("map",this);o.default.rq({url:s.default.moreSpotList+"/"+this.mapId,goBackWithParmas:{id:this.mapId}}).then(function(i){if(200===i.code){e.detail=i.data,e.isUnloack=e.detail.orderId?2:1;var s=[];i.data.scenicSpotList.forEach(function(t){e.what.markers.push({id:t.id,latitude:t.lat,longitude:t.lon,iconPath:"../../static/image/spot.png",width:40,height:48,photo:t.photo,spotName:t.spotName,label:{content:t.spotName,anchorX:-16*(t.spotName.length/2).toFixed(2),fontSize:12,borderWidth:1,borderColor:"#019ce4",padding:4,bgColor:"#fff",color:"#019ce4",borderRadius:10,textAlign:"center"}}),s.push({latitude:t.lat,longitude:t.lon})}),a.includePoints({points:s,padding:[40,40,40,40]})}else e.what.markers=[],t.showToast({title:i.message,icon:"none"}),e.isUnloack=1,e.detail={}})},showDrawer:function(){this.drawerShow=!0},showPay:function(){this.payDialogShow=!0},closeDrawer:function(){this.payDialogShow=!1},handleScMark:function(e){var a=this,i=e.mp;o.default.rq({url:s.default.voice,data:{scenicId:this.detail.id,spotId:i.markerId,narratorId:this.detail.narratorId},header:{"content-type":"application/x-www-form-urlencoded",token:t.getStorageSync("login-token")},goBackWithParmas:{id:this.mapId},loading:!0}).then(function(e){if(200===e.code){if(!e.data)return void t.showToast({title:"没有语音",icon:"none"});a.player["id"]=e.data.id,a.player["voiceUrl"]=e.data.voiceUrl,a.player["voiceName"]=e.data.voiceName,a.what.markers.forEach(function(t){t.id===i.markerId&&(a.player["img"]=t.photo,a.player["spotName"]=t.spotName)}),a.player["playerShow"]=!0}else t.showToast({title:e.message,icon:"none"})})},agree:function(t){this.isXy="yes"==t,this.showRead=!1},mackPay:function(){this.$store.state.MoneyHide&&(this.isXy?this.formSubmit():t.showToast({title:"请阅读协议并同意",icon:"none"}))},formSubmit:function(e){var a=this,i={narratorId:this.detail.narratorId,scenicId:this.detail.id};t.showLoading({title:"生成订单中"}),o.default.rq({url:s.default.createOrder,method:"POST",data:i,goBackWithParmas:{id:this.mapId}}).then(function(e){t.hideLoading(),200===e.code?t.requestPayment({provider:"wxpay",timeStamp:e.data.timeStamp,nonceStr:e.data.nonceStr,package:e.data.packageValue,signType:e.data.signType,paySign:e.data.paySign,success:function(e){t.showToast({title:"支付成功",icon:"none"}),a.payDialogShow=!1,a.getDetail()},fail:function(t){}}):t.showToast({title:"生成订单失败",icon:"none"})})}},watch:{payDialogShow:function(t){!0===t&&(this.isXy=!0)}},computed:r({},(0,c.mapState)(["MoneyHide"]))};e.default=v}).call(this,a("543d")["default"])},d78e:function(t,e,a){"use strict";a("ce60");var i=o(a("b0ce")),s=o(a("8050"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))},fd08:function(t,e,a){}},[["d78e","common/runtime","common/vendor"]]]);